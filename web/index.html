<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HULK Playground</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíö</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0e14;
            --surface: #131820;
            --surface-2: #1a2030;
            --surface-3: #212938;
            --border: #2a3444;
            --border-focus: #4ade80;
            --text: #e2e8f0;
            --text-2: #94a3b8;
            --text-3: #64748b;
            --green: #4ade80;
            --green-dim: #22c55e;
            --green-glow: rgba(74, 222, 128, 0.2);
            --red: #f87171;
            --yellow: #fbbf24;
            --purple: #a78bfa;
            --orange: #fb923c;
            --cyan: #67e8f9;
            --ui: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --mono: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'SF Mono', monospace;
            --header-h: 56px;
            --status-h: 32px;
            --radius: 8px;
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--ui);
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        header {
            height: var(--header-h);
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            flex-shrink: 0;
            z-index: 10;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 18px;
            letter-spacing: -0.5px;
            user-select: none;
        }

        .logo-icon {
            width: 34px;
            height: 34px;
            background: linear-gradient(135deg, var(--green-dim), var(--green));
            border-radius: 9px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 17px;
            font-weight: 800;
            color: #000;
            font-family: var(--mono);
            box-shadow: 0 0 16px var(--green-glow);
            transition: all 0.3s ease;
        }

        .logo-icon:hover {
            transform: rotate(-5deg) scale(1.05);
            box-shadow: 0 0 24px var(--green-glow);
        }

        .logo-text {
            background: linear-gradient(90deg, var(--green), #86efac);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .badges {
            display: flex;
            gap: 8px;
            margin-left: 12px;
        }

        .badge {
            background: var(--surface-2);
            color: var(--text-3);
            font-size: 10px;
            font-family: var(--mono);
            padding: 3px 8px;
            border-radius: 4px;
            border: 1px solid var(--border);
            font-weight: 500;
            letter-spacing: 0.3px;
        }

        .badge.success {
            background: rgba(74, 222, 128, 0.15);
            color: var(--green);
            border-color: rgba(74, 222, 128, 0.3);
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        #run-btn {
            background: linear-gradient(135deg, var(--green-dim), var(--green));
            color: #000;
            border: none;
            border-radius: var(--radius);
            padding: 8px 22px;
            font-family: var(--ui);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 7px;
            transition: all 0.2s;
            box-shadow: 0 0 20px var(--green-glow);
            position: relative;
            overflow: hidden;
        }
        #run-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        #run-btn:hover::before {
            left: 100%;
        }
        #run-btn:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 30px rgba(74, 222, 128, 0.4);
        }
        #run-btn:active { transform: translateY(0); }
        #run-btn.loading { opacity: 0.7; pointer-events: none; }
        #run-btn .spinner {
            display: none;
            width: 14px; height: 14px;
            border: 2px solid rgba(0,0,0,0.2);
            border-top-color: #000;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }
        #run-btn.loading .spinner { display: block; }
        #run-btn.loading .play-icon { display: none; }

        @keyframes spin { 
            to { transform: rotate(360deg); } 
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .output-body {
            animation: fadeIn 0.3s ease;
        }

        .kbd {
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 2px 7px;
            font-size: 11px;
            font-family: var(--mono);
            color: var(--text-3);
            user-select: none;
        }

        /* ‚îÄ‚îÄ MAIN AREA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        main {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .left-sidebar {
            flex: 0 0 300px;
            background: var(--surface);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: flex 0.3s ease;
        }

        .left-sidebar.expanded {
            flex: 1;
        }

        .sidebar-header {
            height: 36px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 14px;
            gap: 10px;
            flex-shrink: 0;
            position: relative;
        }

        .view-toggle {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            color: var(--text-3);
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-family: var(--mono);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .view-toggle:hover {
            background: var(--surface-2);
            color: var(--green);
        }

        .view-toggle.active {
            background: var(--green);
            color: #000;
            font-weight: 600;
        }

        .sidebar-header label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-2);
        }

        .sidebar-header select {
            flex: 1;
            background: var(--surface-2);
            color: var(--text);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 6px 10px;
            font-family: var(--ui);
            font-size: 12px;
            cursor: pointer;
            outline: none;
            transition: all 0.2s;
        }
        .sidebar-header select:hover { 
            border-color: var(--text-3);
            background: var(--surface-3);
        }
        .sidebar-header select:focus { 
            border-color: var(--green);
            box-shadow: 0 0 0 2px rgba(74, 222, 128, 0.15);
        }

        .docs-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            font-family: var(--ui);
            font-size: 13px;
            line-height: 1.65;
            color: var(--text-2);
            max-width: 100%;
            scroll-behavior: smooth;
        }

        .left-sidebar.expanded .docs-container {
            padding: 40px 64px 64px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .left-sidebar.expanded .docs-container h2 {
            font-size: 22px;
            margin-top: 48px;
            margin-bottom: 16px;
        }

        .left-sidebar.expanded .docs-container h2::before {
            height: 24px;
            width: 5px;
        }

        .left-sidebar.expanded .docs-container h3 {
            font-size: 16px;
            margin-top: 24px;
            margin-bottom: 10px;
        }

        .left-sidebar.expanded .docs-container {
            font-size: 14.5px;
            line-height: 1.75;
        }

        .left-sidebar.expanded .docs-container p {
            margin: 12px 0;
        }

        .left-sidebar.expanded .docs-container pre {
            font-size: 13.5px;
            padding: 16px 20px;
            margin: 12px 0 16px;
        }

        .left-sidebar.expanded .docs-container table {
            font-size: 13.5px;
        }

        .left-sidebar.expanded .docs-container .tip,
        .left-sidebar.expanded .docs-container .warning {
            padding: 14px 18px;
            margin: 16px 0;
            font-size: 14px;
        }

        .docs-container h2 {
            color: var(--green);
            font-size: 16px;
            font-weight: 700;
            margin: 24px 0 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border);
            letter-spacing: -0.4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .docs-container h2:first-child { margin-top: 0; }
        .docs-container h2::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--green);
            border-radius: 2px;
        }

        .docs-container h3 {
            color: var(--text);
            font-size: 13.5px;
            font-weight: 600;
            margin: 16px 0 6px;
        }

        .docs-container p {
            margin: 6px 0 10px;
        }

        .docs-container ul {
            margin: 6px 0 10px 18px;
        }

        .docs-container li {
            margin: 4px 0;
        }

        .docs-container code {
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid rgba(74, 222, 128, 0.2);
            border-radius: 4px;
            padding: 2px 7px;
            font-family: var(--mono);
            font-size: 12px;
            color: var(--green);
            font-weight: 500;
        }

        .docs-container pre {
            background: var(--surface-2);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 12px;
            margin: 8px 0;
            overflow-x: auto;
            font-family: var(--mono);
            font-size: 11.5px;
            line-height: 1.5;
            color: var(--text);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .docs-container pre code {
            background: none;
            border: none;
            padding: 0;
            color: inherit;
        }

        .docs-container table {
            width: 100%;
            border-collapse: collapse;
            margin: 8px 0 14px;
            font-size: 12px;
        }

        .docs-container th {
            text-align: left;
            padding: 7px 10px;
            background: var(--surface-2);
            border: 1px solid var(--border);
            color: var(--text);
            font-weight: 600;
            font-size: 12px;
        }

        .docs-container td {
            padding: 5px 10px;
            border: 1px solid var(--border);
        }

        .docs-container td code {
            font-size: 11px;
        }

        .docs-container .tip {
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.08), rgba(74, 222, 128, 0.05));
            border-left: 4px solid var(--green);
            padding: 12px 16px;
            border-radius: 0 8px 8px 0;
            margin: 12px 0;
            font-size: 12.5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .docs-container .tip strong { 
            color: var(--green);
            font-size: 13px;
        }

        .docs-container .warning {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(251, 191, 36, 0.05));
            border-left: 4px solid var(--yellow);
            padding: 12px 16px;
            border-radius: 0 8px 8px 0;
            margin: 12px 0;
            font-size: 12.5px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .docs-container .warning strong { 
            color: var(--yellow);
            font-size: 13px;
        }

        .editor-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 250px;
            transition: all 0.3s ease;
        }

        .editor-panel.hidden {
            display: none;
        }

        .output-panel.hidden {
            display: none;
        }

        .panel-label {
            height: 36px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 16px;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-2);
            gap: 8px;
            flex-shrink: 0;
        }

        .panel-label .dot {
            width: 8px; height: 8px;
            border-radius: 50%;
            background: var(--green);
        }

        #editor { flex: 1; }

        /* ‚îÄ‚îÄ OUTPUT PANEL ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .output-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 250px;
        }

        .output-tabs {
            height: 36px;
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 8px;
            gap: 2px;
            flex-shrink: 0;
        }

        .tab-btn {
            background: transparent;
            border: none;
            color: var(--text-3);
            font-family: var(--ui);
            font-size: 12px;
            font-weight: 500;
            padding: 6px 14px;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.15s;
        }
        .tab-btn:hover { color: var(--text-2); background: var(--surface-2); }
        .tab-btn.active { color: var(--text); background: var(--surface-2); }
        .tab-btn .icon { font-size: 11px; opacity: 0.8; }

        .output-body {
            flex: 1;
            overflow: auto;
            padding: 16px;
            font-family: var(--mono);
            font-size: 13px;
            line-height: 1.7;
            white-space: pre-wrap;
            word-break: break-word;
        }
        .output-body.hidden { display: none; }

        /* Output states */
        .out-ok { color: var(--green); }
        .out-err { color: var(--red); }

        .welcome-msg {
            color: var(--text-3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            gap: 10px;
            font-family: var(--ui);
            font-size: 14px;
        }
        .welcome-msg .big-icon { font-size: 56px; opacity: 0.25; }
        .welcome-msg strong { color: var(--text-2); }

        #llvm-body {
            color: var(--text-3);
            font-size: 11px;
            line-height: 1.4;
        }

        /* ‚îÄ‚îÄ STATUS BAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .status-bar {
            height: var(--status-h);
            background: var(--surface);
            border-top: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            font-size: 11.5px;
            color: var(--text-3);
            flex-shrink: 0;
        }

        .status-left, .status-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 7px; height: 7px;
            border-radius: 50%;
            background: var(--green);
            transition: background 0.2s;
        }
        .status-dot.err { background: var(--red); }
        .status-dot.busy {
            background: var(--yellow);
            animation: pulse 1s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        #docs-body .tip strong { color: var(--green); }

        /* ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--surface-3); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--border); }
    </style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<header>
    <div class="logo">
        <div class="logo-icon">H</div>
        <span class="logo-text">HULK Playground</span>
        <div class="badges">
            <span class="badge">v1.0.0</span>
            <span class="badge success">‚úì 169 tests</span>
        </div>
    </div>
    <div class="controls">
        <button id="run-btn">
            <span class="play-icon">‚ñ∂</span>
            <span class="spinner"></span>
            Ejecutar
        </button>
        <span class="kbd">‚åò‚Üµ</span>
    </div>
</header>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<main>
    <!-- LEFT SIDEBAR: Examples + Documentation -->
    <div class="left-sidebar" id="sidebar">
        <div class="sidebar-header">
            <label>üìù Ejemplos</label>
            <select id="examples">
                <option value="">Selecciona‚Ä¶</option>
                <option value="hello">üü¢ Hello World</option>
                <option value="math">üî¢ Variables y Matem√°ticas</option>
                <option value="functions">‚ö° Funciones Recursivas</option>
                <option value="strings">üìù Cadenas</option>
                <option value="conditionals">üîÄ Condicionales</option>
                <option value="loops">üîÑ Ciclos</option>
                <option value="types">üèóÔ∏è Tipos y Herencia</option>
                <option value="iterables">üì¶ Iterables y For</option>
                <option value="demo">üéØ Demo Completo</option>
            </select>
            <button class="view-toggle" id="view-toggle" title="Ver documentaci√≥n completa">
                <span class="icon">üìñ</span>
                <span class="label">Docs</span>
            </button>
        </div>
        
        <div class="docs-container">
            <h2>üíö HULK Language</h2>
            <p><strong>H</strong>avana <strong>U</strong>niversity <strong>L</strong>anguage for <strong>K</strong>ompilers</p>
            <p>Un lenguaje de expresiones con tipos est√°ticos, herencia, protocolos, funciones de orden superior e iterables.</p>

            <div class="tip">
                <strong>üí° Estructura de un Programa</strong><br>
                Un programa HULK tiene dos partes:<br>
                ‚Ä¢ <b>Declaraciones</b> (top-level): <code>function</code>, <code>type</code>, <code>protocol</code><br>
                ‚Ä¢ <b>Expresi√≥n principal</b>: c√≥digo a ejecutar entre <code>{ }</code>
            </div>

            <h3>Ejemplo B√°sico</h3>
            <pre><code>// Declaraciones arriba
function doble(x) => x * 2;

// C√≥digo ejecutable en { }
{
    print(doble(21));
}</code></pre>

            <h2>üì¶ Variables y Let-In</h2>
            <pre><code>let x = 10, y = 20 in
    print(x + y);

let pi = 3.14159 in
let r = 5 in
    print(pi * r ** 2);</code></pre>
            
            <div class="tip"><strong>Tip:</strong> Las variables en <code>let</code> son inmutables. Para cambiar valores usa <code>:=</code> en variables declaradas como argumentos de funci√≥n o par√°metros de tipo.</div>

            <h2>‚ö° Funciones</h2>
            <h3>Sintaxis</h3>
            <pre><code>// Inline
function suma(a, b) => a + b;

// Con cuerpo
function factorial(n) => 
    if (n <= 1) 1
    else n * factorial(n - 1);

// Con tipos expl√≠citos
function area(r: Number): Number => 
    3.14159 * r ** 2;</code></pre>

            <h3>Funciones de Orden Superior</h3>
            <pre><code>function aplicar(f, x) => f(x);
function cuadrado(x) => x * x;

{
    print(aplicar(cuadrado, 5));
    // Imprime: 25
}</code></pre>

            <h2>üîÄ Condicionales</h2>
            <pre><code>if (x > 0) "positivo"
elif (x < 0) "negativo"
else "cero"</code></pre>

            <div class="warning"><strong>‚ö†Ô∏è</strong> Todas las ramas deben retornar valores del mismo tipo.</div>

            <h2>üîÑ Ciclos</h2>
            <h3>While</h3>
            <pre><code>{
    let x := 0 in
    while (x < 10) {
        print(x);
        x := x + 1;
    };
}</code></pre>

            <h3>For (con Iterables)</h3>
            <pre><code>type Range(start, end) {
    start = start;
    end = end;
    current := start;
    next() => {
        let c = current in {
            current := current + 1;
            c
        };
    };
}

{
    for (x in new Range(1, 6))
        print(x);
}</code></pre>

            <h2>üèóÔ∏è Tipos y Herencia</h2>
            <h3>Declaraci√≥n</h3>
            <pre><code>type Persona(nombre: String, edad: Number) {
    nombre = nombre;
    edad = edad;
    saludar() => print("Hola, soy " @@ nombre);
}

type Estudiante(n, e, carrera) 
    inherits Persona(n, e) {
    carrera = carrera;
    estudiar() => 
        print(nombre @@ " estudia " @@ carrera);
}</code></pre>

            <h3>Uso</h3>
            <pre><code>{
    let p = new Persona("Ana", 25) in {
        p.saludar();
        print(p.edad);
    };
}</code></pre>

            <h2>üìù Operadores</h2>
            <table>
                <tr><th>Operador</th><th>Descripci√≥n</th><th>Ejemplo</th></tr>
                <tr><td><code>+</code> <code>-</code> <code>*</code> <code>/</code></td><td>Aritm√©ticos</td><td><code>2 + 3 * 4</code></td></tr>
                <tr><td><code>**</code></td><td>Potencia</td><td><code>2 ** 8</code> ‚Üí 256</td></tr>
                <tr><td><code>%</code></td><td>M√≥dulo</td><td><code>10 % 3</code> ‚Üí 1</td></tr>
                <tr><td><code>==</code> <code>!=</code></td><td>Igualdad</td><td><code>x == 5</code></td></tr>
                <tr><td><code>&lt;</code> <code>&gt;</code> <code>&lt;=</code> <code>&gt;=</code></td><td>Comparaci√≥n</td><td><code>x &lt; 10</code></td></tr>
                <tr><td><code>&</code> <code>|</code> <code>!</code></td><td>L√≥gicos</td><td><code>a & b</code></td></tr>
                <tr><td><code>@@</code></td><td>Concatenaci√≥n</td><td><code>"Hola" @@ " Mundo"</code></td></tr>
                <tr><td><code>@</code></td><td>String con espacios</td><td><code>"A" @ "B"</code> ‚Üí "A B"</td></tr>
                <tr><td><code>:=</code></td><td>Asignaci√≥n destructiva</td><td><code>x := x + 1</code></td></tr>
                <tr><td><code>=></code></td><td>Define funci√≥n/m√©todo</td><td><code>f(x) => x*2</code></td></tr>
            </table>

            <h2>üéØ Protocolos</h2>
            <pre><code>protocol Drawable {
    draw(): String;
}

type Circle(r) extends Drawable {
    radio = r;
    draw() => "‚≠ï Radio: " @@ radio;
}</code></pre>

            <h2>üîß Built-ins</h2>
            <table>
                <tr><th>Funci√≥n</th><th>Descripci√≥n</th></tr>
                <tr><td><code>print(x)</code></td><td>Imprime en consola</td></tr>
                <tr><td><code>sqrt(x)</code></td><td>Ra√≠z cuadrada</td></tr>
                <tr><td><code>sin(x)</code>, <code>cos(x)</code></td><td>Trigonom√©tricas</td></tr>
                <tr><td><code>exp(x)</code>, <code>log(x)</code></td><td>Exponencial/logaritmo</td></tr>
                <tr><td><code>rand()</code></td><td>N√∫mero aleatorio [0,1)</td></tr>
            </table>

            <div class="tip">
                <strong>üöÄ Tip Pro:</strong> Usa <code>‚åò Enter</code> para ejecutar r√°pidamente. El playground compila a LLVM IR y ejecuta en tiempo real.
            </div>
        </div>
    </div>

    <!-- EDITOR PANEL -->
    <div class="editor-panel">
        <div class="panel-label">
            <span class="dot"></span> main.hulk
        </div>
        <div id="editor"></div>
    </div>

    <div class="output-panel">
        <div class="output-tabs">
            <button class="tab-btn active" data-tab="output">Salida</button>
            <button class="tab-btn" data-tab="llvm">LLVM IR</button>
        </div>
        <div id="output-body" class="output-body">
            <div class="welcome-msg">
                <span class="big-icon">üíö</span>
                <div>Presiona <strong>‚ñ∂ Ejecutar</strong> o <strong>‚åò Enter</strong></div>
                <div>para compilar y ejecutar tu c√≥digo HULK</div>
            </div>
        </div>
        <div id="llvm-body" class="output-body hidden"></div>
    </div>
</main>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê STATUS BAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="status-bar">
    <div class="status-left">
        <span class="status-dot" id="status-dot"></span>
        <span id="status-text">Listo</span>
    </div>
    <div class="status-right">
        <span id="time-display"></span>
        <span>HULK v0.1.0</span>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MONACO EDITOR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.min.js"></script>
<script>

// ‚îÄ‚îÄ Ejemplos de c√≥digo HULK ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const EXAMPLES = {

hello: `// ¬°Tu primer programa en HULK!
{
    print("¬°Hola Mundo!");
    print("Bienvenido a HULK üíö");
}
`,

math: `// Variables con let-in y operadores matem√°ticos
{
    let pi = 3.14159 in
    let r = 5 in
    let area = pi * r ** 2 in {
        print("Radio:" @@ r);
        print("√Årea del c√≠rculo:" @@ area);
        print("Per√≠metro:" @@ (2 * pi * r));
    };
}
`,

functions: `// Funciones recursivas con =>
function factorial(n: Number): Number =>
    if (n <= 1) 1
    else n * factorial(n - 1);

function fibonacci(n: Number): Number =>
    if (n <= 1) n
    else fibonacci(n - 1) + fibonacci(n - 2);

{
    print("factorial(5) =" @@ factorial(5));
    print("factorial(10) =" @@ factorial(10));
    print("fibonacci(10) =" @@ fibonacci(10));
    print("fibonacci(15) =" @@ fibonacci(15));
}
`,

strings: `// @ concatena cadenas, @@ concatena con espacio
{
    let nombre = "HULK" in
    let version = "1.0" in {
        print("Lenguaje: " @ nombre @ " v" @ version);
        print("Hola" @@ "Mundo");
        print("2 + 3 =" @@ (2 + 3));
        print("PI =" @@ 3.14159);
    };
}
`,

conditionals: `// if / elif / else como expresiones
function clasificar(n: Number): String =>
    if (n > 0) "positivo"
    elif (n < 0) "negativo"
    else "cero";

function abs(x: Number): Number =>
    if (x < 0) (0 - x) else x;

function max(a: Number, b: Number): Number =>
    if (a >= b) a else b;

{
    print("5 es" @@ clasificar(5));
    print("-3 es" @@ clasificar(-3));
    print("0 es" @@ clasificar(0));
    print("|‚àí42| =" @@ abs(0 - 42));
    print("max(7, 12) =" @@ max(7, 12));
}
`,

loops: `// While loop con variables mutables
{
    let i = 0 in
    let sum = 0 in {
        while (i < 10) {
            i := i + 1;
            sum := sum + i;
        };
        print("Suma de 1 a 10 =" @@ sum);
    };

    // Conteo con condici√≥n
    let n = 1 in
    let pares = 0 in {
        while (n <= 20) {
            if (n % 2 == 0) pares := pares + 1
            else 0;
            n := n + 1;
        };
        print("Pares en [1,20]:" @@ pares);
    };
}
`,

types: `// Sistema de tipos con herencia
type Animal(name: String, sound: String) {
    name: String = name;
    sound: String = sound;
    speak(): String => self.name @ " dice: " @ self.sound;
}

type Dog(name: String) inherits Animal(name, "Guau!") {
    fetch(): String => self.name @ " busca la pelota!";
}

type Cat(name: String) inherits Animal(name, "Miau!") {
    purr(): String => self.name @ " ronronea...";
}

let rex = new Dog("Rex") in
let luna = new Cat("Luna") in {
    print(rex.speak());
    print(rex.fetch());
    print(luna.speak());
    print(luna.purr());
}
`,

iterables: `// Protocolo Iterable con tipo Range
type Range(min: Number, max: Number) {
    min: Number = min;
    max: Number = max;
    current: Number = min - 1;
    next(): Boolean => {
        self.current := self.current + 1;
        self.current < self.max;
    };
    get_current(): Number => self.current;
}

function range(min: Number, max: Number): Range =>
    new Range(min, max);

// For loop ‚Äî se transpila a while(iter.next())
{
    print("Contando del 1 al 5:");
    for (x in range(1, 6))
        print("  ‚Üí" @@ x);

    // Sumatoria con while
    let sum = 0 in
    let r = range(1, 101) in {
        while (r.next())
            let n = r.get_current() in
                sum := sum + n;
        print("Suma 1..100 =" @@ sum);
    };
}
`,

demo: `// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HULK Demo Completo ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

// ‚Äî Funciones matem√°ticas ‚Äî
function abs(x: Number): Number =>
    if (x < 0) (0 - x) else x;

function factorial(n: Number): Number =>
    if (n <= 1) 1
    else n * factorial(n - 1);

function max(a: Number, b: Number): Number =>
    if (a >= b) a else b;

// ‚Äî Tipos con herencia ‚Äî
type Shape(name: String) {
    name: String = name;
    describe(): String => "Forma: " @ self.name;
}

type Circle(radius: Number) inherits Shape("Circulo") {
    radius: Number = radius;
    area(): Number => 3.14159 * self.radius ** 2;
}

type Square(side: Number) inherits Shape("Cuadrado") {
    side: Number = side;
    area(): Number => self.side ** 2;
}

// ‚Äî Iterable ‚Äî
type Range(min: Number, max: Number) {
    min: Number = min;
    max: Number = max;
    current: Number = min - 1;
    next(): Boolean => {
        self.current := self.current + 1;
        self.current < self.max;
    };
    get_current(): Number => self.current;
}

function range(min: Number, max: Number): Range =>
    new Range(min, max);

// ‚ïê‚ïê‚ïê Ejecuci√≥n ‚ïê‚ïê‚ïê
{
    print("=== HULK Demo ===");
    print("factorial(7) =" @@ factorial(7));
    print("|‚àí42| =" @@ abs(0 - 42));
    print("max(99, 42) =" @@ max(99, 42));

    let c = new Circle(5) in {
        print(c.describe());
        print("  Radio:" @@ c.radius);
        print("  Area:" @@ c.area());
    };

    let s = new Square(4) in {
        print(s.describe());
        print("  Lado:" @@ s.side);
        print("  Area:" @@ s.area());
    };

    print("Primeros 5 cuadrados:");
    for (n in range(1, 6))
        print("  " @@ n @ "^2 =" @@ (n ** 2));

    print("=== FIN ===");
}
`
};

// ‚îÄ‚îÄ Monaco setup ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

require.config({
    paths: { vs: 'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs' }
});

require(['vs/editor/editor.main'], function () {

    // ‚îÄ‚îÄ Registrar lenguaje HULK ‚îÄ‚îÄ

    monaco.languages.register({ id: 'hulk' });

    monaco.languages.setMonarchTokensProvider('hulk', {
        keywords: [
            'let', 'in', 'if', 'elif', 'else', 'while', 'for',
            'function', 'type', 'inherits', 'protocol', 'extends',
            'new', 'print', 'true', 'false', 'self', 'is', 'as', 'not'
        ],
        typeKeywords: ['Number', 'String', 'Boolean', 'Object'],
        operators: [':=', '=>', '@@', '@', '**', '>=', '<=', '!=', '=='],

        tokenizer: {
            root: [
                [/\/\/.*$/, 'comment'],
                [/"[^"]*"/, 'string'],
                [/\d+(\.\d+)?([eE][+-]?\d+)?/, 'number'],
                [/[a-zA-Z_]\w*/, {
                    cases: {
                        '@keywords': 'keyword',
                        '@typeKeywords': 'type.identifier',
                        '@default': 'identifier'
                    }
                }],
                [/:=|=>|@@|@|\*\*/, 'operator'],
                [/[+\-*/%]/, 'operator'],
                [/[><=!]=?/, 'operator'],
                [/[&|]/, 'operator'],
                [/[{}()\[\]]/, '@brackets'],
                [/[;,.:]+/, 'delimiter'],
                [/\s+/, 'white'],
            ]
        }
    });

    // Auto-completado b√°sico
    monaco.languages.registerCompletionItemProvider('hulk', {
        provideCompletionItems: function (model, position) {
            const word = model.getWordUntilPosition(position);
            const range = {
                startLineNumber: position.lineNumber,
                endLineNumber: position.lineNumber,
                startColumn: word.startColumn,
                endColumn: word.endColumn
            };
            const kw = (label, insert) => ({
                label, kind: monaco.languages.CompletionItemKind.Keyword,
                insertText: insert || label, range,
                insertTextRules: insert ? monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet : 0
            });
            return {
                suggestions: [
                    kw('print', 'print($1);'),
                    kw('let', 'let ${1:x} = ${2:value} in\n    $0'),
                    kw('function', 'function ${1:name}(${2:args}): ${3:Type} =>\n    $0;'),
                    kw('type', 'type ${1:Name}(${2:args}) {\n    $0\n}'),
                    kw('inherits', 'inherits ${1:Parent}($2)'),
                    kw('if', 'if ($1) $2\nelse $0'),
                    kw('while', 'while ($1) {\n    $0\n};'),
                    kw('for', 'for (${1:x} in ${2:iterable})\n    $0;'),
                    kw('self'),
                    kw('new', 'new ${1:Type}($2)'),
                    kw('true'), kw('false'),
                    kw('Number'), kw('String'), kw('Boolean'),
                ]
            };
        }
    });

    // ‚îÄ‚îÄ Theme personalizado ‚îÄ‚îÄ

    monaco.editor.defineTheme('hulk-dark', {
        base: 'vs-dark',
        inherit: true,
        rules: [
            { token: 'keyword',         foreground: '4ade80', fontStyle: 'bold' },
            { token: 'type.identifier',  foreground: 'a78bfa' },
            { token: 'string',          foreground: 'fbbf24' },
            { token: 'number',          foreground: 'fb923c' },
            { token: 'comment',         foreground: '6b7280', fontStyle: 'italic' },
            { token: 'operator',        foreground: '67e8f9' },
            { token: 'delimiter',       foreground: '636e7b' },
            { token: 'identifier',      foreground: 'e2e8f0' },
            { token: '@brackets',       foreground: 'cbd5e1' },
        ],
        colors: {
            'editor.background':               '#0d1117',
            'editor.foreground':               '#e2e8f0',
            'editorLineNumber.foreground':     '#3b4557',
            'editorLineNumber.activeForeground': '#8b949e',
            'editorCursor.foreground':         '#4ade80',
            'editor.selectionBackground':      '#264f7860',
            'editor.lineHighlightBackground':  '#161b2266',
            'editorIndentGuide.background1':    '#1e293b',
            'editorWidget.background':         '#161b22',
            'editorWidget.border':             '#2a3444',
            'editorSuggestWidget.background':  '#161b22',
            'editorSuggestWidget.border':      '#2a3444',
            'editorSuggestWidget.selectedBackground': '#264f7840',
        }
    });

    // ‚îÄ‚îÄ DOM refs ‚îÄ‚îÄ

    const outputBody  = document.getElementById('output-body');
    const llvmBody    = document.getElementById('llvm-body');
    const statusDot   = document.getElementById('status-dot');
    const statusText  = document.getElementById('status-text');
    const timeDisplay = document.getElementById('time-display');
    let editor; // Declarar editor aqu√≠ para que est√© accesible

    // ‚îÄ‚îÄ Ejecutar c√≥digo ‚îÄ‚îÄ

    window.runCode = async function() {
        const btn = document.getElementById('run-btn');
        if (!btn) return;
        if (!editor) return;

        // Estado: compilando
        btn.classList.add('loading');
        statusDot.className = 'status-dot busy';
        statusText.textContent = 'Compilando‚Ä¶';
        timeDisplay.textContent = '';
        outputBody.innerHTML = '<span style="color:var(--text-3)">‚è≥ Compilando y ejecutando‚Ä¶</span>';
        llvmBody.textContent = '';

        // Cambiar a tab salida
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelector('[data-tab="output"]').classList.add('active');
        outputBody.classList.remove('hidden');
        llvmBody.classList.add('hidden');

        try {
            const resp = await fetch('/api/run', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ code: editor.getValue() })
            });

            const data = await resp.json();

            if (data.success) {
                statusDot.className = 'status-dot';
                statusText.textContent = 'Ejecuci√≥n exitosa';
                outputBody.innerHTML = '<span class="out-ok">' + esc(data.output) + '</span>';
            } else {
                statusDot.className = 'status-dot err';
                statusText.textContent = 'Error';
                let html = '';
                if (data.output) html += esc(data.output);
                if (data.errors) html += '<span class="out-err">' + esc(data.errors) + '</span>';
                outputBody.innerHTML = html || '<span class="out-err">Error desconocido</span>';
            }

            if (data.llvm_ir) llvmBody.textContent = data.llvm_ir;
            timeDisplay.textContent = data.time_ms + 'ms';

        } catch (err) {
            statusDot.className = 'status-dot err';
            statusText.textContent = 'Error de conexi√≥n';
            outputBody.innerHTML = '<span class="out-err">‚ùå No se pudo conectar al servidor.\nAseg√∫rate de que el playground est√° corriendo:\n\n  cargo run --bin hulk-playground</span>';
        }

        btn.classList.remove('loading');
    }

    // ‚îÄ‚îÄ Crear editor ‚îÄ‚îÄ

    editor = monaco.editor.create(document.getElementById('editor'), {
        value: EXAMPLES.hello,
        language: 'hulk',
        theme: 'hulk-dark',
        fontSize: 14,
        fontFamily: "'JetBrains Mono', 'Fira Code', monospace",
        fontLigatures: true,
        minimap: { enabled: false },
        padding: { top: 16, bottom: 16 },
        scrollBeyondLastLine: false,
        renderLineHighlight: 'all',
        smoothScrolling: true,
        cursorBlinking: 'smooth',
        cursorSmoothCaretAnimation: 'on',
        bracketPairColorization: { enabled: true },
        automaticLayout: true,
        suggest: { showKeywords: true },
        tabSize: 4,
        wordWrap: 'on',
    });

    // ‚îÄ‚îÄ Atajo de teclado: Cmd+Enter ‚îÄ‚îÄ
    editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => window.runCode());

    // ‚îÄ‚îÄ Helper function ‚îÄ‚îÄ
    function esc(text) {
        const d = document.createElement('div');
        d.textContent = text;
        return d.innerHTML;
    }

    // ‚îÄ‚îÄ Selector de ejemplos ‚îÄ‚îÄ

    document.getElementById('examples').addEventListener('change', function (e) {
        const key = e.target.value;
        if (key && EXAMPLES[key]) {
            editor.setValue(EXAMPLES[key]);
            // Reset output
            outputBody.innerHTML = '<div class="welcome-msg"><span class="big-icon">üíö</span><div>C√≥digo cargado ‚Äî presiona <strong>‚ñ∂ Ejecutar</strong></div></div>';
            llvmBody.textContent = '';
            statusDot.className = 'status-dot';
            statusText.textContent = 'Listo';
            timeDisplay.textContent = '';
        }
        e.target.selectedIndex = 0;
    });

    // ‚îÄ‚îÄ Bot√≥n ejecutar ‚îÄ‚îÄ
    const runBtn = document.getElementById('run-btn');
    if (runBtn) {
        console.log('Bot√≥n encontrado, agregando listener');
        runBtn.addEventListener('click', () => {
            console.log('Click detectado!');
            window.runCode();
        });
    } else {
        console.error('No se encontr√≥ el bot√≥n run-btn');
    }

    // ‚îÄ‚îÄ View Toggle (Editor ‚Üî Docs) ‚îÄ‚îÄ
    
    const sidebar = document.getElementById('sidebar');
    const editorPanel = document.querySelector('.editor-panel');
    const outputPanel = document.querySelector('.output-panel');
    const viewToggle = document.getElementById('view-toggle');
    let docsMode = false;

    viewToggle.addEventListener('click', () => {
        docsMode = !docsMode;
        
        if (docsMode) {
            sidebar.classList.add('expanded');
            editorPanel.classList.add('hidden');
            outputPanel.classList.add('hidden');
            viewToggle.classList.add('active');
            viewToggle.querySelector('.label').textContent = 'Editor';
            viewToggle.querySelector('.icon').textContent = '‚å®Ô∏è';
            viewToggle.title = 'Volver al editor';
        } else {
            sidebar.classList.remove('expanded');
            editorPanel.classList.remove('hidden');
            outputPanel.classList.remove('hidden');
            viewToggle.classList.remove('active');
            viewToggle.querySelector('.label').textContent = 'Docs';
            viewToggle.querySelector('.icon').textContent = 'üìñ';
            viewToggle.title = 'Ver documentaci√≥n completa';
        }
    });

    // ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ

    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function () {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            const tab = this.dataset.tab;
            outputBody.classList.toggle('hidden', tab !== 'output');
            llvmBody.classList.toggle('hidden', tab !== 'llvm');
        });
    });
});
</script>
</body>
</html>
